<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    
    <meta content="IE=8" http-equiv="X-UA-Compatible"/>
    <title>OCaml :: OCaml Planet</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <meta content="Ashish Agarwal, Esther Baruk, Christophe Troestler and many contributors" name="author"/>
    <meta content="" name="description"/>
    <meta content="" name="keywords"/>
    <meta content="OCaml (Weberizer)" name="generator"/>

    <link href="https://static.ocamlcore.org/official/images/favicon.ico" rel="shortcut icon"/>
    <link rel="stylesheet" href=".././css/bootstrap.css"/>
    <link href=".././css/ocaml.css" media="all" type="text/css" rel="stylesheet"/>
    <link rel="stylesheet" href=".././css/bootstrap-responsive.css"/>

    
    

    <meta content="OCaml Planet" property="og:title"/>
    <meta content="non_profit" property="og:type"/>

    <meta content="all" name="robots"/>
  </head>
  <body>
    <div id="header">
      <div class="top">
      </div>
      <div class="bottom">
      </div>
    </div>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
	  
          <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a href=".././" class="brand">OCaml</a>

          <div class="nav-collapse">
            <ul class="nav">
	      <li class="dropdown">
  <a href="../#" class="dropdown-toggle" data-toggle="dropdown">
    Discover
    <b class="caret"></b>
  </a>
  <ul class="dropdown-menu">
    <li><a href="../description.html">What is OCaml?</a></li>
    <li><a href="http://try.ocamlpro.com/">Try it Online</a></li>
    <li><a href="../taste.html">100 Lines of OCaml</a></li>
    <li><a href="../success.html">Success Stories</a></li>
    <li><a href="../companies.html">Who Is Using It?</a></li>
    <li><a href="http://pleac.sourceforge.net/pleac_ocaml/">Pleac</a></li>
    <li><a href="http://rosettacode.org/wiki/Category:OCaml">Rosetta</a>
        <a href="http://langref.org/ocaml">langref.org</a></li>
  </ul>
</li>
<li class="dropdown">
  <a href="../#" class="dropdown-toggle" data-toggle="dropdown">
    Learn
    <b class="caret"></b></a>
  <ul class="dropdown-menu">
    <li><a href="../install.html">Install</a></li>
    <li><a href="../tutorials/">Tutorials</a></li>
    <li><a href="../faq.html">FAQ</a></li>
    <li><a href="../books.html">Books</a></li>
    <li><a href="../videos.html">Videos</a></li>
    <li><a href="../papers.html">Papers</a></li>
  </ul>
</li>
<li class="dropdown">
  <a href="../#" class="dropdown-toggle" data-toggle="dropdown">Use
    <b class="caret"></b></a>
  <ul class="dropdown-menu">
    <li><a href="../releases/latest.html">Releases</a></li>
    <li><a href="../libraries.html">Libraries</a></li>
    <li><a href="../dev_tools.html">Development Tools</a></li>
    <li><a href="../books.html#manual">User Manual</a></li>
    <li><a href="../cheat_sheets.html">Cheat Sheets</a></li>
    <li><a href="http://search.ocaml.jp/">OCaml API Search</a></li>
    <li><a href="http://forge.ocamlcore.org/">Forge</a></li>
    <li><a href="https://github.com/languages/OCaml">GitHub</a></li>
    <li><a href="https://bitbucket.org/repo/all?name=ocaml">Bitbucket</a></li>
  </ul>
</li>
<li class="dropdown">
  <a href="../#" class="dropdown-toggle" data-toggle="dropdown">Community
    <b class="caret"></b></a>
  <ul class="dropdown-menu">
    <li><a href="../mailing_lists.html">Mailing Lists</a></li>
    <li><a href="../planet/">Blogs</a></li>
    <li><a href="../meetings.html">Meetings</a></li>
    <li><a href="irc://irc.freenode.net/ocaml">IRC</a></li>
    <li><a href="http://stackoverflow.com/questions/tagged?tagnames=ocaml">Stack Overflow</a></li>
    <li><a href="http://www.reddit.com/r/ocaml/">Reddit</a></li>
    <li><a href="../support.html">Commercial Support</a></li>
  </ul>
</li>
<li class="dropdown">
  <a href="../#" class="dropdown-toggle" data-toggle="dropdown">More
    <b class="caret"></b></a>
  <ul class="dropdown-menu">
    <li><a href="http://caml.inria.fr/mantis/">Mantis Bug Tracker</a></li>
    <li><a href="../caml-light/">Caml Light</a></li>
    <li><a href="../logos.html">Logos</a></li>
  </ul>
</li>

            </ul>
	    <form action="http://www.google.com/search" method="get" class="navbar-search pull-right">
	      <input placeholder="Search" class="search-query" name="q" type="text"/>
	      <input value="site:http://www.ocaml.org/" name="q" type="hidden"/>
	    </form>
            
	    
          </div>
        </div>
      </div>
    </div>

    <div class="container">
      <span class="navigation-bar">
	<a href="./../">Home</a><span class="separation"><img src=".././img/right_arrow.png" alt="&gt;"/></span>OCaml Planet
	<span id="language">
	  <span class="horizontal-toolbar"><span class="open-bracket">[</span><span class="current-url">En</span><span class="close-bracket">]</span></span>
	</span>
      </span>

      

    <h1>OCaml Planet</h1>

    <p>The OCaml Planet aggregates various blogs from the OCaml
    community.  It is kindly provided
    by <a href="http://www.ocamlcore.com/">OCamlCore</a>.  If you
    would like to be added, read
    the <a href="http://www.ocamlcore.org/planet/">Planet
    subscription HOWTO</a>.</p>

    <br/>
    <div style="float: right; margin-right: 0; margin-top: 0" class="span2 planet-subscriptions"><em>Subscriptions</em>
      <ul><li><a href="http://alexleighton.tumblr.com/tagged/ocaml/rss">Alex Leighton</a></li><li><a href="http://blog.mestan.fr/feed/?cat=16">Alp Mestan</a></li><li><a href="http://andreiformiga.com/blog/?cat=5&feed=rss2">Andrei Formiga</a></li><li><a href="http://math.andrej.com/feed/">Andrej Bauer</a></li><li><a href="http://anil.recoil.org/feeds/atom.xml">Anil Madhavapeddy</a></li><li><a href="http://unnali.com/tag/ocaml/feed/">Arlen Cuss</a></li><li><a href="http://ashishagarwal.org/tag/ocaml/feed/">Ashish Agarwal</a></li><li><a href="http://www.blogger.com/feeds/7617521785419311079/posts/default">Cameleon news</a></li><li><a href="http://caml.inria.fr/news.en.rss">Caml INRIA</a></li><li><a href="http://camlspotter.blogspot.com/feeds/posts/default?alt=rss">Caml Spotting</a></li><li><a href="http://alan.petitepomme.net/cwn/cwn.rss">Caml Weekly News</a></li><li><a href="http://procrastiblog.com/category/ocaml/feed/">Christopher Conway</a></li><li><a href="http://coherentpdf.com/blog/?tag=ocaml&feed=rss">Coherent Graphics</a></li><li><a href="http://coq.inria.fr/news/feed">Coq</a></li><li><a href="http://erratique.ch/feeds/news.atom">Daniel Bünzli</a></li><li><a href="http://blog.dbpatterson.com/rss">Daniel Patterson</a></li><li><a href="http://nleyten.com/atom.aspx">Dario Teixeira</a></li><li><a href="http://www.blogger.com/feeds/17133288/posts/default/-/ocaml">David Baelde</a></li><li><a href="http://bentobako.org/david/blog/index.php?feed/tag/ocaml/atom">David Mentré</a></li><li><a href="http://dutherenverseauborddelatable.wordpress.com/category/ocaml/feed/">David Teller</a></li><li><a href="http://www.examachine.net/blog/?feed=rss2&cat=4">Eray Özkural</a></li><li><a href="http://www.mega-nerd.com/erikd/Blog/CodeHacking/Ocaml/index.rss20">Erik de Castro Lopo</a></li><li><a href="http://blog.emillon.org/feeds/ocaml.xml">Etienne Millon</a></li><li><a href="http://www.mega-nerd.com/erikd/Blog/FP-Syd/index.rss20">FP-Sydney</a></li><li><a href="http://www.blogger.com/feeds/8964007124326996693/posts/default/-/ocaml">Fayssal Martani</a></li><li><a href="http://frama-c.com/rss.xml">Frama-C</a></li><li><a href="http://functionaljobs.com/jobs/search/?q=ocaml&format=rss">Functional Jobs</a></li><li><a href="http://gallium.inria.fr/blog/index.rss">GaGallium</a></li><li><a href="http://gaiustech.wordpress.com/category/ocaml/feed/">Gaius Hammond</a></li><li><a href="http://blog.camlcity.org/blog/rss">Gerd Stolpmann</a></li><li><a href="http://www.wisdomandwonder.com/tag/OCaml/feed">Grant Rettke</a></li><li><a href="http://blog.incubaid.com/tag/ocaml/feed/">Incubaid Research</a></li><li><a href="http://ambassadortothecomputers.blogspot.com/feeds/posts/default?alt=rss">Jake Donham</a></li><li><a href="http://scattered-thoughts.net/rss?tag=ocaml">Jamie Brandon</a></li><li><a href="http://ocaml.janestcapital.com/?q=rss.xml">Jane Street</a></li><li><a href="http://www.lexifi.com/blogs/ocaml/feed">LexiFi</a></li><li><a href="http://savonet.sourceforge.net/liquidsoap.rss">Liquidsoap</a></li><li><a href="http://syntaxexclamation.wordpress.com/tag/ocaml/feed/">Matthias Puech</a></li><li><a href="http://www.blogger.com/feeds/5888658295182480819/posts/default">Matías Giovannini</a></li><li><a href="http://eigenclass.org/R2/feeds/rss2/all">Mauricio Fernandez</a></li><li><a href="http://www.elehack.net/michael/blog/tags/ocaml?format=rss">Michael Ekstrand</a></li><li><a href="http://www.rktmb.org:82/feed/category/work/ocaml/atom">Mihamina Rakotomandimby</a></li><li><a href="http://mcclurmc.wordpress.com/feed/">Mike McClurg</a></li><li><a href="http://nyc-ocaml.posterous.com/rss.xml">NYC OCaml</a></li><li><a href="http://ocamlhackers.ning.com/profiles/blog/feed?tag=ocaml&xn_auth=no">OCaml Hackers</a></li><li><a href="http://forge.ocamlcore.org/export/rss_sfnews.php">OCamlCore Forge News</a></li><li><a href="http://forge.ocamlcore.org/export/rss_sfprojects.php">OCamlCore Forge Projects</a></li><li><a href="http://www.ocamlcore.com/wp/?feed=rss2&amp;language=en&#038;language=en">OCamlCore.com</a></li><li><a href="http://www.ocamlpro.com/feed/atom.xml">OCamlPro</a></li><li><a href="http://odns.tuxfamily.org/feed/">ODNS project</a></li><li><a href="http://ox.tuxfamily.org/feed/">Ocaml XMPP project</a></li><li><a href="http://ocsigen.org/news.atom">Ocsigen project</a></li><li><a href="http://www.blogger.com/feeds/2073503406800427577/posts/default">Opa</a></li><li><a href="http://www.openmirage.org/blog/atom.xml">Open Mirage</a></li><li><a href="http://functional-orbitz.blogspot.com/feeds/posts/default/-/planetocaml?alt=rss">Orbitz</a></li><li><a href="http://www.donadeo.net/facets/programming-languages/objective-caml/feed/">Paolo Donadeo</a></li><li><a href="https://mancoosi.org/~abate/taxonomy/term/5/0/feed">Pietro Abate</a></li><li><a href="http://redlizards.com/blog/feed/?tag=ocaml">Red Lizard Software</a></li><li><a href="http://rwmj.wordpress.com/tag/ocaml/feed/">Richard Jones</a></li><li><a href="http://blog.rastageeks.org/spip.php?page=rss&id_mot=2">Romain Beauxis</a></li><li><a href="http://seb.mondet.org/blog/feed/ocaml.rss">Sebastien Mondet</a></li><li><a href="http://upsilon.cc/~zack/tags/ocaml/index.rss">Stefano Zacchiroli</a></li><li><a href="http://le-gall.net/sylvain+violaine/blog/index.php?feed/tag/ocaml/atom">Sylvain Le Gall</a></li><li><a href="http://caml.inria.fr/hump.rss">The Caml Humps</a></li><li><a href="http://www.blogger.com/feeds/6115529230232389198/posts/default">Till Varoquaux</a></li><li><a href="http://www.nicollet.net/toroidal/ocaml/feed/">Victor Nicollet</a></li><li><a href="http://y-node.com/blog/feeds/tag/ocaml/">y-node</a></li></ul>

      <a href="http://planet.ocaml.org/rss20.xml"><img src=".././img/rss20.png"/></a>
      <a href="http://planet.ocaml.org/opml.xml"><img src=".././img/opml.png"/></a>
    </div>
    <div class="planet"><a name="4500c6dfee297759b237d6b0101e99f5"></a><span class="rss-header"><span class="rss-title"><a href="http://bentobako.org/david/blog/index.php?post/2013/01/28/The-failures-of-Debian-%28and-its-derivatives%29"> The failures of Debian (and its derivatives)</a></span>&nbsp;&mdash;&nbsp;<span class="rss-author">David Mentré</span>, <span class="rss-date">27 Jan 2013</span></span><span class="rss-description"><div id="post1"><p>I am a long term Debian user. I have used Debian since probably the mid 90' up to now. I use latest Debian stable on my personal server or at work, and Ubuntu on my desktop and laptop machines at home. Using it does not mean I am entirely satisfied with it to say the least. I think the distribution is not making enough efforts for its users and I'll try to explain why. Of course, YYMV. ;-)</p>

<a onclick="switchContent('post1','post2')" class="btn" href="#4500c6dfee297759b237d6b0101e99f5">Read more...</a></div><div id="post2" style="display: none"><p>I am a long term Debian user. I have used Debian since probably the mid 90' up to now. I use latest Debian stable on my personal server or at work, and Ubuntu on my desktop and laptop machines at home. Using it does not mean I am entirely satisfied with it to say the least. I think the distribution is not making enough efforts for its users and I'll try to explain why. Of course, YYMV. ;-)</p>

<ul>
<li><strong>Debian packaging is made for developers, not users</strong>. Debian has too many packages. To take just one example, the OCaml compiler is packaged into the main compiler, its libraries, the native compiler and the byte code one, etc. Why so many packages? If I am an OCaml developer, I want all of them so why do I need to manually find (the naming is far from being obvious, at least for beginners) and install so many packages? I have heard of several reasons: it allows to factorise common parts between the different binary architectures, it allows to install the command line only parts without the graphics parts, it allows to install only what the user wants, etc. For me, those reasons are just plain wrong. We have more and more disk capacity on our machines so disk usage is no longer a limitation. The package should be able to dynamically activate the graphic parts automatically if the X server is available. And the factorisation of shared parts between Debian architectures should be done on the servers storing the packages, not trough the packaging system.</li>
</ul>
<ul>
<li><strong>Debian has out-dated software</strong>. Debian Wheezy is about to be released and it will have GNOME 3.4. But GNOME 3.6 is already out and GNOME 3.8 is on its way. And I am taking GNOME as an example, it is the same issue for lot of software within Debian. I have heard this is for stability issues. But software packaged in Debian is already stable! It should take 10 or 15 days to integrate a new software into Debian stable, not months or even years (the time between successive stable releases). I acknowledge that some packages have complex interdependencies between each others. For example, when a new release of the OCaml compiler is out, one needs to recompile all OCaml packages. But this constraint is only for OCaml packages. Why should I wait for a new stable version of Debian to get the newly released OCaml compiler? For me this sounds just plain wrong.</li>
</ul>
<ul>
<li><strong>Nobody uses plain Debian stable</strong>. Debian developers are using unstable. Debian users are using Debian stable, but enriched with backports because of out-dated software. Or derivatives like Ubuntu. The fact the Debian developers are not using what they recommend to users is bogus. I know they do that for technical reasons, but that should not be a good reason. Debian developers should use what they are providing to their users, except maybe for a few packages they are working on.</li>
</ul>
<ul>
<li><strong>There are too many dependencies between packages</strong>. The dependency system of Debian is a nice piece of work, it was ahead of its time when it was created. But the use of dependencies has been perverted. The dependencies are manually computed (thus source of errors and bugs) and at the same time any software can write to about any part of the file system. Due to too many dependencies and lack of clean interfaces between sub-systems, the installation of a recent user software can trigger a ton of packages down to a new kernel or libc. Why is it so? I think the sub-systems of Debian (e.g. the X graphical infrastructure, the kernel and base C libraries, the OCaml system, ...) should be isolated the one from the others. It would allow them to be updated without waiting for the others. Having dependencies between 29,000 packages is just not scalable. It is even more true if those dependencies are manually computed.</li>
</ul>
<ul>
<li><strong>Debian packaging is lacking automation</strong>. I am a developer. Debian packagers are developers. It always astonished me how much manual work should be done to make and maintain a Debian package. All developers know that if they want to be efficient, they need to automate their work as much as possible, so as to be able to focus their manpower on the complex parts. Everything should be automated in Debian packages, starting from a minimal description file. Automation should be the default (package creation, test, static analysis, ...), not the exception.</li>
</ul>
<ul>
<li><strong>One cannot install simultaneously several versions of the same software</strong>. As a user or developer, I want to use the stable version of a piece of software and maybe the latest stable version that just have been released in order to do a few tests or check that my software still compiles with the new shiny compiler. Debian does not allow me to do that. And if I install a newer package, downgrading to the previous version is complex and error prone.</li>
</ul>
<ul>
<li><strong>Debian is undocumented</strong>. I am not talking about the installation guide which is nice, I am talking about the modifications made to software by Debian developers. Doing modification on the "standard" (for the software) way of configuring or using it has always seemed suspect to me, even if I agree that having harmonized configuration is a real advantage (all configuration files in /etc for example). But all of those modifications should be documented in README.Debian file. To take an example, the last time I tried to install the dokuwiki Debian package, I was unable to configure it! The way to add new users had been changed compared to a regular dokuwiki (the web interface was disabled), and those changes were undocumented. It should be a release critical bug! Without proper documentation, the user cannot use the software. And, of course, the reason behind those changes should be questioned, even for security reasons (a very secure but unusable software is superfluous. Security is a trade-off).</li>
</ul>

<p>So, why I am complaining? Why I do not become a Debian Developer, so I can fix it? Because a single developer is not going to change the root causes of those issues. They need a massive development effort, or at least a massive acknowledgement by the Debian Developers. And I don't have ready-made answers to those issues (even if I have some ideas to solve them).</p>


<p>Is the grass greener in the other fields? I don't think so, or at least I am not aware of it. I like Debian for is community approach, its focus on Free Software (even if it is sometimes imperfect) and the wide range of software packaged in it (the OCaml packages are numerous for example). I just hope that the whole Debian community will focus on more user related issues in the future.</p><a onclick="switchContent('post2','post1')" class="btn" href="#4500c6dfee297759b237d6b0101e99f5">Hide</a></div></span>
<a name="424619e247ac889e3831cad027ca6cea"></a><span class="rss-header"><span class="rss-title"><a href="https://forge.ocamlcore.org/forum/forum.php?forum_id=868"> Batteries 2.0 released</a></span>&nbsp;&mdash;&nbsp;<span class="rss-author">OCamlCore Forge News</span>, <span class="rss-date">25 Jan 2013</span></span><span class="rss-description"><pre class="rss-text">Get it here: https://forge.ocamlcore.org/frs/download.php/1096/batteries-2.0.tar.gz

Detailed interface changes: https://forge.ocamlcore.org/frs/download.php/1096/batteries-2.0.tar.gz

API Docs: http://ocaml-batteries-team.github.com/batteries-included/hdoc2/index.html</pre></span>
<a name="04575a20f97416d0bb3e0e4c8838006c"></a><span class="rss-header"><span class="rss-title"><a href="http://caml.inria.fr/cgi-bin/hump.cgi?contrib=842"> Odoc_xref 4.00</a></span>&nbsp;&mdash;&nbsp;<span class="rss-author">The Caml Humps</span>, <span class="rss-date">23 Jan 2013</span></span><span class="rss-description">Custom ocamldoc html generator with the capability to cross-reference material from libraries.</span>
<a name="b03d054bf8056f3b9f28f2b490e2b194"></a><span class="rss-header"><span class="rss-title"><a href="http://caml.inria.fr/cgi-bin/hump.cgi?contrib=418"> odoc_check 4.00</a></span>&nbsp;&mdash;&nbsp;<span class="rss-author">The Caml Humps</span>, <span class="rss-date">23 Jan 2013</span></span><span class="rss-description">A generator which performs some controls on the collected information. For example: all values are commented, all types are commented, all exceptions have a version tag, ... All the possible controls are turned on/off with command line options.</span>
<a name="423079778ca22bf57a1d0ef2bdafca38"></a><span class="rss-header"><span class="rss-title"><a href="http://alan.petitepomme.net/cwn/2013.01.22.html"> Caml Weekly News, 22 Jan 2013</a></span>&nbsp;&mdash;&nbsp;<span class="rss-author">Caml Weekly News</span>, <span class="rss-date">22 Jan 2013</span></span><span class="rss-description">beta-release of OPAM / Stog 0.6 is out / Hash function: complexity and circular structures / sedlex = ulex without camlp4 / Fan, a promising replacement of camlp4 / Job offer on formal methods (fixed term contract)</span>
<a name="bf0e2735f8f0b5477bcbc182f76daa9c"></a><span class="rss-header"><span class="rss-title"><a href="http://www.ocamlpro.com/blog/2013/01/17/opam-beta.html"> Beta-release of OPAM</a></span>&nbsp;&mdash;&nbsp;<span class="rss-author"><span id="ocaml_1">OCamlPro &#9001;thomas<abbr title="(at) &rarr; @">(at)</abbr>ocamlpro.com (Thomas Gazagnaire)&#9002;</span><script type="text/javascript"><!--;
local = "thomas";
h = "ocamlpro.com (Thomas Gazagnaire)";
document.getElementById("ocaml_1").innerHTML = '<a href="mailto:' + local + '@' + h + "\" >OCamlPro<\/a>";
//--></script></span>, <span class="rss-date">17 Jan 2013</span></span><span class="rss-description"><div id="post3"><p>OPAM is a source-based package manager for OCaml. It supports multiple simultaneous compiler installations, flexible package constraints, and a Git-friendly development workflow. I have recently announced the beta-release of OPAM on the <a href="https://sympa.inria.fr/sympa/arc/caml-list/2013-01/msg00073.html">caml-list</a>, and this blog post introduces the basics to new OPAM users.</p><h2>Why OPAM</h2><a onclick="switchContent('post3','post4')" class="btn" href="#bf0e2735f8f0b5477bcbc182f76daa9c">Read more...</a></div><div id="post4" style="display: none"><p>OPAM is a source-based package manager for OCaml. It supports multiple simultaneous compiler installations, flexible package constraints, and a Git-friendly development workflow. I have recently announced the beta-release of OPAM on the <a href="https://sympa.inria.fr/sympa/arc/caml-list/2013-01/msg00073.html">caml-list</a>, and this blog post introduces the basics to new OPAM users.</p><h2>Why OPAM</h2><p>We have decided to start writing a brand new package manager for OCaml in the beginning of 2012, after looking at the state of affairs in the OCaml community and not being completely satisfied with the existing solutions, especially regarding the management of dependency constraints between packages. Existing technologies such as GODI, oasis, odb and ocamlbrew did contain lots of good ideas that we shamelessly stole but the final user-experience was not so great -- and we disagreed with some of the architectural choices, so it wasn't so easy to contribute to fix the existing flaws. Thus we started to discuss the specification of a new package manager with folks from <a href="http://www.janestreet.com/">Jane Street</a> who decided to fund the project and from the <a href="http://www.mancoosi.org/">Mancoosi project</a> to integrate state-of-the-art dependency management technologies. We then hired an engineer to do the initial prototyping work -- and this effort finally gave birth to OPAM!</p><h2>Installing OPAM</h2><p>OPAM packages are already available for homebrew, macports and arch-linux. Debian and Ubuntu packages should be available quite soon. In any cases, you can either use a <a href="http://www.ocamlpro.com/pub/opam_install.sh">binary installer</a> or simply install it from <a href="https://github.com/OCamlPro/opam/archive/0.9.1.tar.gz">sources</a>. To learn more about the installation process, read the <a href="http://opam.ocamlpro.com/doc/Quick_Install.html">installation instructions</a>.</p><h2>Initializing OPAM</h2><p>Once you've installed OPAM, you have to initialize it. OPAM will store all its state under <code>~/.opam</code>, so if you want to reset your OPAM configuration, simply remove that directory and restart from scratch. OPAM can either use the compiler installed on your system or it can also install a fresh version of the compiler:</p><pre><code>opam init                # Use the system compiler
opam init --comp 4.00.1  # Use OCaml 4.00.1
</code></pre><p>OPAM will prompt you to add a shell script fragment to your <code>.profile</code>. It is highly recommended to follow these instructions, as it let OPAM set-up correctly the environment variables it needs to compile and configure the packages.</p><h2>Getting help</h2><p>OPAM user manual is integrated:</p><pre><code>opam --help       # Get help on OPAM itself
opam init --help  # Get help on the init sub-command
</code></pre><h2>Basic commands</h2><p>Once OPAM is initialized, you can ask it to list the available packages, get package information and search for a given pattern in package descriptions:</p><pre><code>opam list *foo* # list all the package containing 'foo' in their name
opam info foo   # Give more information on the 'foo' package
opam search foo # search for the string 'foo' in all package descriptions
</code></pre><p>Once you've found a package you would like to install, just run the usual <code>install</code> command.</p><pre><code>opam install lwt # install lwt and its dependencies
opam remove lwt  # remove lwt and its dependencies
</code></pre><p>Later on, you can check whether new packages are available and you can upgrade your package installation.</p><pre><code>opam update  # check if new packages are available
opam upgrade # upgrade your packages to the latest version
</code></pre><p>Casual users of OCaml won't need to know more about OPAM. Simply remind to update and upgrade OPAM regularly to keep your system up-to-date.</p><h2>Use-case 1: Managing Multiple Compilers</h2><p>A new release of OCaml is available and you want to be able to use it. How to do this in OPAM ? This is as simple as:</p><pre><code>opam update        # pick-up the latest compiler descriptions
opam switch 4.00.2 # switch to the new 4.00.2 release
opam switch export --switch=system | opam switch import -y
</code></pre><p>The first line will get the latest package and compiler descriptions, and will tell you if new packages or new compilers are available. Supposing that 4.00.2 is now available, you can then <code>switch</code> to that version using the second command. The last command imports all the packages installed by OPAM for the OCaml compiler installed on your system (if any).</p><p>You can also easily use the latest unstable version of OCaml if you want to give it a try:</p><pre><code>opam switch 4.01.0dev+trunk            # install trunk
opam switch reinstall 4.01.0dev+trunk  # reinstall trunk
</code></pre><p>Reinstalling trunk means getting the latest changesets and recompiling the packages already installed for that compiler switch.</p><h2>Use-case 2: Managing Multiple Repositories</h2><p>Sometimes, you want to let people use a new version of your software early. Or you are working in a company and expose internal libraries to your coworkers but you don't want them to be available to anybody using OPAM. How can you do that with OPAM? It's easy! You can set-up your own repository (see for instance <a href="https://github.com/xen-org/opam-repo-dev/">xen-org</a>'s development packages) and add it to your OPAM configuration:</p><pre><code>opam repository list  # list the repositories available in your config
opam repository add xen-org git://github.com/xen-org/opam-repo-dev.git
opam repository list  # new xen-org repository available
</code></pre><p>This will add the repository to your OPAM configuration and it will display the newly available packages. The next time you run <code>opam update</code> OPAM will then scan for any change in the remote git repository.</p><p>Repositories can either be local (e.g. on your filesystem), remote (available through HTTP) and stored in git or darcs.</p><h2>Use-case 3: Using Development Packages</h2><p>You want to try the latest version of a package which have not yet been released, or you have a patched version of a package than you want to try. How could you do it? OPAM has a <code>pin</code> sub-command which let you do that easily:</p><pre><code>opam pin lwt /local/path/
opam install lwt          # install the version of lwt stored in /local/path
</code></pre><p>You can also use a given branch in a given git repository. For instance, if you want the library <code>re</code> to be compiled with the code in the <code>experimental</code> branch of its development repository you can do:</p><pre><code>opam pin re git://github.com/ocaml/ocaml-re.git#experimental
opam install re
</code></pre><p>When building the packages, OPAM will use the path set-up with the pin command instead of using the upstream archives. Also, on the next update, OPAM will automatically check whether some changes happened and if the packages needs to be recompiled:</p><pre><code>opam update lwt     # check for changes in /local/path
opam update re      # check for change in the remote git branch
opam upgrade lwt re # upgrade re and lwt if necessary
</code></pre><h2>Conclusion</h2><p>I've briefly explained some of the main features of OPAM. If you want to go further, I would advise to read the <a href="http://opam.ocamlpro.com/doc/Advanced_Usage.html">user</a> and <a href="http://opam.ocamlpro.com/doc/Packaging.html">packager</a> tutorials. If you really want to understand the internals of OPAM, you can also read the <a href="https://github.com/OCamlPro/opam/blob/master/doc/dev-manual/dev-manual.pdf?raw=true">developer manual</a>.</p><a onclick="switchContent('post4','post3')" class="btn" href="#bf0e2735f8f0b5477bcbc182f76daa9c">Hide</a></div></span>
<a name="05a101c34a2fc7b16276151cfe69ec68"></a><span class="rss-header"><span class="rss-title"><a href="http://alan.petitepomme.net/cwn/2013.01.15.html"> Caml Weekly News, 15 Jan 2013</a></span>&nbsp;&mdash;&nbsp;<span class="rss-author">Caml Weekly News</span>, <span class="rss-date">15 Jan 2013</span></span><span class="rss-description">Batteries 2.0.0 released / wrap/unwrap some OCaml code in Emacs / some beautiful OCaml code / PG'OCaml 1.7 / FoCaLiZe 0.8.0 / new meetup: OUPS - Ocaml Users in PariS and OPAM Party / ilist-0.1.0 - indexed lists / Propagating types to pattern-matching / Other Caml News</span>
<a name="3334b47d818f5851b16fb17012df1bd2"></a><span class="rss-header"><span class="rss-title"><a href="http://www.lexifi.com/blog/static-exceptions"> Static exceptions</a></span>&nbsp;&mdash;&nbsp;<span class="rss-author">LexiFi</span>, <span class="rss-date">11 Jan 2013</span></span><span class="rss-description"><div class="content-wide-padding white-bg light-grey-border">
<p>
  In this post, I propose Static Exceptions as a new language feature
  allowing programmers to express interesting control flows in a
  compact way.
</p></div><p><a href="http://www.lexifi.com/blog/static-exceptions" target="_blank">read more</a></p></span>
<a name="fefc7d1a5e469089727c2abf979df4b3"></a><span class="rss-header"><span class="rss-title"><a href="http://gallium.inria.fr/blog/introduction-to-mezzo"> Introduction to Mezzo</a></span>&nbsp;&mdash;&nbsp;<span class="rss-author">GaGallium</span>, <span class="rss-date">11 Jan 2013</span></span><span class="rss-description"><div id="post5"><p>Some of you may have heard about it already: this blog post is about a new programming language that's being designed right there at Gallium, codenamed <em><strong>Mezzo</strong></em>.</p>
<p>Designing a new programming language is nothing out of the extraordinary: many students in our research area do it for a living, and I'm no exception. I've been doing the traveling salesman, running presentations of Mezzo all over the place: Texas, New York, and going even as far as <em>Plateau de Saclay</em>. Now is the time for a blog post.</p>
<p><em><strong>Mezzo</strong></em> is a joint work between François Pottier, my advisor, and myself. Recently, Thibaut Balabonski joined our team as a post-doctoral researcher to work on the concurrent aspects of the language; we also had an undergrad intern, Henri Chataing, work on the compilation part of the project.</p>
<a onclick="switchContent('post5','post6')" class="btn" href="#fefc7d1a5e469089727c2abf979df4b3">Read more...</a></div><div id="post6" style="display: none"><p>Some of you may have heard about it already: this blog post is about a new programming language that's being designed right there at Gallium, codenamed <em><strong>Mezzo</strong></em>.</p>
<p>Designing a new programming language is nothing out of the extraordinary: many students in our research area do it for a living, and I'm no exception. I've been doing the traveling salesman, running presentations of Mezzo all over the place: Texas, New York, and going even as far as <em>Plateau de Saclay</em>. Now is the time for a blog post.</p>
<p><em><strong>Mezzo</strong></em> is a joint work between François Pottier, my advisor, and myself. Recently, Thibaut Balabonski joined our team as a post-doctoral researcher to work on the concurrent aspects of the language; we also had an undergrad intern, Henri Chataing, work on the compilation part of the project.</p>
<p><em><strong>Mezzo</strong></em> draws inspiration from many other research projects; I don't want to bother the reader with a long introduction -- this is not a research paper: I will provide an extended comparison of our work with other material in a later blog post. For the moment, let me just mention that we blend ideas from affine type systems, separation logic, and systems based on regions and capabilities.</p>
<p><em><strong>Mezzo</strong></em> is still in a preliminary stage, but I feel like it is time to start the revolution, and introduce this almighty language to a wider audience. Behold!</p>




<h3 id="what-is-mezzo">What is <em><strong>Mezzo</strong></em>?</h3>
<p><em><strong>Mezzo</strong></em><sup><a href="http://gallium.inria.fr/blog/index.rss#fn1" id="fnref1" class="footnoteRef">1</a></sup> draws most of its inspiration from ML. Therefore, a big chunk of the language reads and feels just like ML (keywords: strict evaluation, functional, impure). However, there's a reason we're designing a new language: we want to go further than ML.</p>
<ul>
<li>We want to reject some programs previously accepted by ML; in a sense, we want to forbid patterns we consider dangerous.</li>
<li>Conversely, we want to accept some programs previously deemed unsafe by an ML type-checker: we want to make more programming patterns possible.</li>
</ul>
<p>Most of these improvements come at a cost, naturally. The design that I'm about to introduce is still very much in flux, and time will tell whether the cognitive cost of our new system is worth the benefits.</p>
<p>However, we deliberately tried to cut down the complexity of the system: in a sense, we don't want to end up doing proofs within the type system. Therefore, the mechanisms that I'm about to introduce may seem low-tech compared to recent research works, but we believe that's what makes it possible to explain the language to a (seasoned) ML programmer, and also what makes writing a type-checker relatively doable, without requiring a huge burden of annotations from the programmer.</p>
<h3 id="permissions">Permissions</h3>
<p>This blog post assumes that the reader is familiar with ML; in particular, the reader is expected to know what references are, what a boxed value is, and how only things in the heap may be mutable.</p>
<p>One of the goals for <em><strong>Mezzo</strong></em> is to offer better control of <em>aliasing</em> and <em>ownership</em> of mutable data. In order to make this possible, <em><strong>Mezzo</strong></em> replaces the traditional concept of "type" with that of "permission".</p>
<p>In essence, one can view a permission as a conceptual access token to a part of the heap, that is, a heaplet. A permission both describes the shape of the heaplet, and grants its owner the right to <em>access</em> this heaplet. Permissions are an artefact of the type system: they do not exist at runtime.</p>
<p>Consider the following piece of code:</p>
<pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span class="kw">let</span> x = (2, <span class="st">"foo"</span>) <span class="kw">in</span>
...</code></pre>
<p>Right after this line of code, a new permission is made available to the programmer, namely <code>x @ (int, string)</code>. This permission basically tells the programmer that <code>x</code> points to a block in the heap, with two fields. The first one contains an integer, and the second one contains a pointer to a string. Moreover, the permission grants its owner the right to access this portion of the heap.</p>
<p>At any given point in the program, a set of permissions is available. They determine the fragment of the heap that we can access at this point of the program.</p>
<p>In the example above, several permissions may be available along <code>x @ (int, string)</code>; we chose to focus on the small subset of permissions we are interested in. In general, there is more than just one permission available in a given scope; for instance, we may have <code>x @ (int, string) ∗ y @ float</code>, that is, both <code>x @ (int, string)</code> and <code>y @ float</code> at the same time: <code>∗</code> denotes the conjunction of two permissions<sup><a href="http://gallium.inria.fr/blog/index.rss#fn2" id="fnref2" class="footnoteRef">2</a></sup>.</p>
<h4 id="what-are-permissions-useful-for">What are permissions useful for?</h4>
<h5 id="a-simple-example-the-length-function">A simple example: the <code>length</code> function</h5>
<p>So far, there's nothing new here. Let us stay low-tech for a moment and consider the signature of the <code>length</code> function that, as the name suggests, computes the length of a <code>list</code>.</p>
<pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span class="kw">val</span> length: [a] (x: <span class="dt">list</span> a) -&gt; <span class="dt">int</span></code></pre>
<p><code>[a]</code> denotes universal quantification, that is, <code>length</code> is valid for any type <code>a</code>, and <code>x</code> is a binder, that is, it gives us a way to talk about the argument of <code>length</code>.</p>
<p>The <code>length</code> function, in order to perform its job, requires that the <em>caller</em> passes it the "right" to read the list at address <code>x</code>. We say that this function needs the permission <code>x @ list a</code> to run: indeed, it needs to iterate over the elements of the list in order to compute its length, and the aforementioned permission enables it to do just that.</p>
<p>We understand this function to <em>return to its caller</em> the permission <code>x @ list a</code>, along with a value of type <code>int</code>. In other words, if comments denote the permissions available at a given program point:</p>
<pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span class="co">(* empty *)</span>
<span class="kw">let</span> x = ... <span class="kw">in</span>
<span class="co">(* x @ list a *)</span>
<span class="kw">let</span> l = length x <span class="kw">in</span>
<span class="co">(* l @ int ∗ x @ list a *)</span></code></pre>
<p>The permission <code>x @ list a</code> is temporarily taken from the caller's context, conceptually passed to the <code>length</code> function for the duration of its execution, then returned to the caller once <code>length</code> terminates.</p>
<h5 id="a-more-sophisticated-example-the-mswap-function">A more sophisticated example: the <code>mswap</code> function</h5>
<p>We are now ready to move on to a more sophisticated example that will demonstrate the power of <em><strong>Mezzo</strong></em>! We now consider <em>mutable</em> pairs of elements, which we write as <code>mpair a b</code> (think <code>('a, 'b) mpair</code><sup><a href="http://gallium.inria.fr/blog/index.rss#fn3" id="fnref3" class="footnoteRef">3</a></sup>). We wish to write a function that will swap, <em>in place</em>, the two components of a pair. That is, without allocating a fresh pair.</p>
<p>What is the type for this function?</p>
<pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span class="kw">val</span> mswap: [a, b] (consumes x: mpair a b) -&gt; (| x @ mpair b a)</code></pre>
<p>Let us review this fairly complex type. There are several elements at play here.</p>
<ul>
<li>Unlike the <code>length</code> example, the argument <code>x</code> is <em>consumed</em>, that is, when the caller passes the <code>x @ mpair a b</code> permission to <code>mswap</code>, it <em>loses it</em>.</li>
<li>However, <code>mswap</code> will return to the caller a different permission saying that <code>x</code>, after <code>mswap</code> has run, has a different type, namely <code>x @ mpair b a</code>.</li>
<li>The <code>(|p)</code> syntax indicates that the function returns a permission <code>p</code>, but no value<sup><a href="http://gallium.inria.fr/blog/index.rss#fn4" id="fnref4" class="footnoteRef">4</a></sup></li>
</ul>
<pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span class="co">(* empty *)</span>
<span class="kw">let</span> x = ... <span class="kw">in</span>
<span class="co">(* x @ mpair a b *)</span>
mswap x;
<span class="co">(* x @ mpair b a *)</span></code></pre>
<p>This is a function that we cannot write in ML. Indeed, in order for this function to be sound, we must make sure that no one else can ever hold an <em>outdated</em> copy of <code>x @ mpair a b</code>. Therefore, <code>mswap</code> must have an <em>exclusive</em> access to its argument. <em><strong>Mezzo</strong></em> provides such a guarantee: <em>mutable portions of the heap are guaranteed to have a unique owner</em>; therefore, <code>mswap</code> <em>does</em> have an exclusive access to its argument: <code>x @ mpair a b</code> is an exclusive permission, and the system guarantees that it has an unique owner. In particular, as soon as <code>mswap</code> runs, the caller has lost its permission on <code>x</code>.</p>
<h4 id="different-flavors-of-permissions">Different flavors of permissions</h4>
<p>Getting back to our very first example, the fragment of the heap that the permission <code>x @ (int, string)</code> describes is immutable; therefore, it is safe to share this knowledge with others. In other words, <em>this permission can be freely copied</em>, and passed to other parts of the programs (think about threads, for instance). This permission is said to be <em>duplicable</em>.</p>
<p>As we just saw, not all permissions are duplicable. Because <em><strong>Mezzo</strong></em> aims to control aliasing to mutable data, we make sure that only one person at a time can "see" a mutable fragment of the heap: this is of utmost importance when it comes to concurrency. The way we enforce this is by forbidding duplication of such a permission. For instance, <code>x @ mpair a b</code> is said to be <em>exclusive</em>, and <em>cannot</em> be copied.</p>
<p>Therefore, having two copies of a permission is not necessarily the same as having just one copy.</p>
<h5 id="the-mode-system">The mode system</h5>
<p>Some functions can only be type-checked if they know that their argument is duplicable. The <code>find</code> function, because it returns a pointer to an element in the list, must require that the type of the elements in the list be duplicable: indeed, because a pointer to the element is returned to the caller <em>and</em> remains in the list at the same time, there are two people pointing to it, so it better be duplicable.</p>
<p>We express this fact using a mode constraint:</p>
<pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span class="kw">val</span> find: [a] duplicable a =&gt; (a -&gt; <span class="dt">bool</span>, <span class="dt">list</span> a) -&gt; <span class="dt">option</span> a</code></pre>
<h4 id="accounting-for-aliasing-relationships">Accounting for aliasing relationships</h4>
<p>So far, we've seen that <em><strong>Mezzo</strong></em> provides a better control of ownership by making sure a mutable part of the heap has a unique owner; <em><strong>Mezzo</strong></em> also describes effects in a more accurate manner compared to traditional ML, by leveraging permissions to give finer-grained types to functions.</p>
<p><em><strong>Mezzo</strong></em> is able to talk about aliasing as well, through the use of <em>singleton types</em>. A singleton type basically means "same as", as is written <code>=t</code>. For instance, if a variable <code>x</code> "has type" <code>=y</code>, this means that <code>x</code> and <code>y</code> are aliases for each other. We write <code>x @ =y</code> or, more concisely, <code>x = y</code>.</p>
<pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span class="kw">let</span> x = ... <span class="kw">in</span>
<span class="co">(* x @ τ *)</span>
<span class="kw">let</span> y = x <span class="kw">in</span>
<span class="co">(* x @ τ ∗ y = x *)</span>
...</code></pre>
<p>The important point here is that we <em>did not duplicate</em> the permission <code>x @ τ</code>, which would be illegal, since we know nothing about <code>τ</code>. We merely added a new permission that accounts for the aliasing relationship.</p>
<p>Similarly, if we hold <code>x @ mpair a b</code>, we know that <code>x</code> points to a block in the heap with two slots, the first one having type <code>a</code> and the second one having type <code>b</code>. This amounts to the following drawing:</p>
<pre><code>
                                            (l)
                                   ,-----,     
           ,---------------------&gt; |  a  |     
(x)       /                        `-----`     
   ,-----/------------,                        
   |    /   |         |                     (r)
   |  left  |  right  |            ,-----,     
   |        |     \   |       ,--&gt; |  b  |     
   `---------------\--`      /     `-----`     
                    \       /                  
                     `-----`                   
</code></pre>
<p><em><strong>Mezzo</strong></em> is able to accurately reflect this aliasing pattern through the permission system. Let us consider the definition (finally!) of the <code>mpair</code> type.</p>
<pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span class="kw">mutable</span> data mpair a b =
  <span class="dt">MPair</span> { left: a; right: b }</code></pre>
<p>In <em><strong>Mezzo</strong></em>, sum type and record types are fused together. <em><strong>Mezzo</strong></em> is able to automatically transform:</p>
<pre><code>x @ mpair a b</code></pre>
<p>into</p>
<pre><code>x @ MPair { left: a; right: b }</code></pre>
<p>thus reflecting the fact that <code>x</code> is a block with two fields, named left and right. However, just like I've given names to the two anonymous blocks with types <code>a</code> and <code>b</code>, <em><strong>Mezzo</strong></em> will introduce names for these components and say that this permission is also equivalent to the following conjunction:</p>
<pre><code>x @ MPair { left: = l; right: = r } ∗ l @ a ∗ r @ b</code></pre>
<p>We write this more concisely as:</p>
<pre><code>x @ MPair { left = l; right = r } ∗ l @ a ∗ r @ b</code></pre>
<p>(note the <code>left = l</code> shorthand without a colon).</p>
<h4 id="a-final-example">A final example</h4>
<p>Here is an example that puts all these mechanisms together: the implementation of the <code>mswap</code> function. As usual, comments indicate the set of available permissions.</p>
<pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span class="kw">val</span> mswap [a, b] (consumes x: mpair a b): (| x @ mpair b a) =
  <span class="co">(* We start off with:</span>
<span class="co">     x @ mpair a b</span>
<span class="co">   which the type-checker automatically converts into:</span>
<span class="co">     x @ MPair { left = l; right = r } ∗ l @ a ∗ r @ b *)</span>
  <span class="kw">let</span> t = x.left <span class="kw">in</span>
  <span class="co">(* x @ MPair { left = l; right = r } ∗ l @ a ∗ r @ b ∗ t = l *)</span>
  x.left &lt;- x.right;
  <span class="co">(* x @ MPair { left = r; right = r } ∗ l @ a ∗ r @ b ∗ t = l *)</span>
  x.right &lt;- t
  <span class="co">(* We end up with:</span>
<span class="co">     x @ MPair { left = r; right = t } ∗ l @ a ∗ r @ b ∗ t = l</span>
<span class="co">   which the type-checker automatically converts into:</span>
<span class="co">     x @ mpair a b</span>
<span class="co">   in order to satisfy the return type of the function. *)</span></code></pre>
<p>At the end of the function, the type-checker, in order to satisfy the return type of the function, must check that the final expression "has type" <code>()</code>, that is, the unit type: it is the case. It must also check that the new permission <code>x @ mpair b a</code> is available: by recombining the final set of permissions, we can indeed trade it for <code>x @ mpair b a</code>: the return condition of the function is satisfied, and the example above will type-check<sup><a href="http://gallium.inria.fr/blog/index.rss#fn5" id="fnref5" class="footnoteRef">5</a></sup>:</p>
<p>The expressive power of <em><strong>Mezzo</strong></em> allows it to accurately reflect the aliasing and points-to relationships in the type system. This is what makes this example type-check, since we need a very precise reasoning in order to justify its soundness. In a sense, the permission system is close, in this example, to symbolic execution, or abstract interpretation.</p>
<h3 id="an-incomplete-presentation-of-mezzo">An incomplete presentation of Mezzo</h3>
<p>The permission mechanism is very good at describing local relationships between identifiers, but this very precise description cannot scale to larger<sup><a href="http://gallium.inria.fr/blog/index.rss#fn6" id="fnref6" class="footnoteRef">6</a></sup>, more complex structures such as doubly-linked lists. Indeed, there are some patterns that the permission system cannot express at this stage: if a list contains the same exclusive element twice, for instance, the permission system will never accept such a list: there would be two ways of reaching the exclusive element, which means that one could gain two permissions for it: this is something that the system explicitly disallows.</p>
<p>In a second blog post, I will detail the main contribution that we bring with <em><strong>Mezzo</strong></em>, namely, a powerful adoption and abandon mechanism that provides a way to express these examples using permissions, at the expense of having dynamic checks.</p>
<h3 id="some-bonus-examples">Some bonus examples</h3>
<p>In case you are still skeptical about the benefits of such a sophisticated (if not complex) type system, here are some examples slightly more motivating than the <code>mswap</code> example which, I admit, will rarely pop up "in the real world".</p>
<p>These examples are taken from the test suite of our prototype type-checker. I'll give a brief overview of the current state of our type-checker in a subsequent post.</p>
<h4 id="tail-recursive-listconcat-without-obj.magic">Tail-recursive <code>list::concat</code> without <code>Obj.magic</code></h4>
<p>This function is written in destination-passing-style; that is, the <code>concat1</code> function keeps a pointer to the previous cell. Cells are mutable: they represent an "unfinished" list cell; once their <code>tail</code> field has been mutated, <code>cell</code>s can be "frozen" into a regular list cell, thus enabling tail-recursion.</p>
<pre class="sourceCode ocaml"><code class="sourceCode ocaml">data <span class="dt">list</span> a =
  | <span class="dt">Cons</span> { head: a; tail: <span class="dt">list</span> a }
  | <span class="dt">Nil</span>

<span class="kw">mutable</span> data cell a =
  | <span class="dt">Cell</span> { head: a; tail: () }

<span class="kw">val</span> <span class="kw">rec</span> concat1 [a] (
   consumes dst: cell a,
   consumes xs: <span class="dt">list</span> a,
   consumes ys: <span class="dt">list</span> a): (| dst @ <span class="dt">list</span> a)
  =
  <span class="kw">match</span> xs <span class="kw">with</span>
  | <span class="dt">Nil</span> -&gt;
      dst.tail &lt;- ys;
      tag <span class="kw">of</span> dst &lt;- <span class="dt">Cons</span>
  | <span class="dt">Cons</span> { head; tail } -&gt;
      <span class="kw">let</span> dst' = <span class="dt">Cell</span> {
        head = head; tail = ()
      } <span class="kw">in</span>
      dst.tail &lt;- dst';
      tag <span class="kw">of</span> dst &lt;- <span class="dt">Cons;</span>
      concat1 (dst', tail, ys)
  end

<span class="kw">val</span> concat [a] (
   consumes xs: <span class="dt">list</span> a,
   consumes ys: <span class="dt">list</span> a): <span class="dt">list</span> a
  =
  <span class="kw">match</span> xs <span class="kw">with</span>
  | <span class="dt">Nil</span> -&gt;
      ys
  | <span class="dt">Cons</span> { head; tail } -&gt;
      <span class="kw">let</span> dst = <span class="dt">Cell</span> {
        head = head; tail = ()
      } <span class="kw">in</span>
      concat1 (dst, tail, ys);
      dst
  end</code></pre>
<p>We also have a tail-recursive version of <code>map</code> that uses the exact same trick.</p>
<h4 id="computing-the-size-of-a-tree">Computing the size of a tree</h4>
<p>The following function:</p>
<ul>
<li>computes the size of a tree,</li>
<li>while annotating all sub-trees with their sizes,</li>
<li>accepts a tree that was previously annotated with any kind of data.</li>
</ul>
<pre class="sourceCode ocaml"><code class="sourceCode ocaml"><span class="kw">mutable</span> data tree a = 
  | <span class="dt">Node</span> { left: tree a; right: tree a; size: a }
  | <span class="dt">Leaf</span>

<span class="kw">val</span> <span class="kw">rec</span> tree_size (consumes x: tree unknown): (<span class="dt">int</span> | x @ tree <span class="dt">int</span>) =
  <span class="kw">match</span> x <span class="kw">with</span>
  | <span class="dt">Leaf</span> -&gt;
      1
  | <span class="dt">Node</span> { left; right } -&gt;
      <span class="kw">let</span> l = tree_size left <span class="kw">in</span>
      <span class="kw">let</span> r = tree_size right <span class="kw">in</span>
      <span class="kw">let</span> total = l + r + 1 <span class="kw">in</span>
      x.size &lt;- total;
      total
  end</code></pre>
<div class="footnotes">
<hr/>
<ol>
<li id="fn1"><p>Former names for this language include: "the language of the future" and "Ha<strong>ML</strong>eT". My very own proposal of "Kre<strong>ML</strong>in" never really took off.<a href="http://gallium.inria.fr/blog/index.rss#fnref1">↩</a></p></li>
<li id="fn2"><p>A man of the trade will undoubtedly feel an immediate familiary with separation logic. Indeed, our <code>*</code> conjunction acts as a separating conjunction on <em>exclusive</em> portions of the heap. On <em>duplicable</em> portions of the heap, it merely indicates that the set of permissions must be consistent with itself. More on that in the next section.<a href="http://gallium.inria.fr/blog/index.rss#fnref2">↩</a></p></li>
<li id="fn3"><p>Unlike OCaml, type applications are done the same way as term applications, namely, left-to-right.<a href="http://gallium.inria.fr/blog/index.rss#fnref3">↩</a></p></li>
<li id="fn4"><p>The <code>(t|p)</code> syntax allows one to bundle a type <code>t</code> along with a permission <code>p</code>. For the special case where <code>t</code> is equal to the unit type <code>()</code>, we write <code>(|p)</code>.<a href="http://gallium.inria.fr/blog/index.rss#fnref4">↩</a></p></li>
<li id="fn5"><p>Function types are always annotated in <em><strong>Mezzo</strong></em>: we specify the type of the arguments as well as the return type of the function. If the function needs any extra permissions to run, these must be specified as well.<a href="http://gallium.inria.fr/blog/index.rss#fnref5">↩</a></p></li>
<li id="fn6"><p>Precisely, the permission system we just saw cannot express structures of arbitrary length with sharing.<a href="http://gallium.inria.fr/blog/index.rss#fnref6">↩</a></p></li>
</ol>
</div><a onclick="switchContent('post6','post5')" class="btn" href="#fefc7d1a5e469089727c2abf979df4b3">Hide</a></div></span>
<a name="fe4a9758a84119967b2ef7808523bb20"></a><span class="rss-header"><span class="rss-title"><a href="http://erratique.ch/software"> Winter distribution</a></span>&nbsp;&mdash;&nbsp;<span class="rss-author">Daniel Bünzli</span>, <span class="rss-date">05 Jan 2013</span></span><span class="rss-description">Release of Cmdliner 0.9.3, Uutf 0.9.2, Uunf 0.9.1 and Uucd 0.9.2. Consult the individual release notes for details.</span>
<script type="text/javascript">function switchContent(id1,id2) {
     // Get the DOM reference
     var contentId1 = document.getElementById(id1);
     var contentId2 = document.getElementById(id2);
     // Toggle
     contentId1.style.display = "none";
     contentId2.style.display = "block";
     }</script></div>

  
    </div>

    
    <br/>
    <hr/>
    <div id="footer">
      Contribute to this project!
      Find us on <a href="https://github.com/ocaml/ocaml.org">Github</a>.
    </div>
    <span title=".././img/ = image directory from the base of the site"></span>


    
    
    

    <script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
    <script src=".././js/jquery-1.8.0.min.js"></script>
    
    <script src=".././js/bootstrap.js"></script>

    <script type="text/javascript">
      var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-22552764-2']); _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-37808023-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

    </script>

</body></html>
