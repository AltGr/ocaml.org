<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    
    <meta content="IE=8" http-equiv="X-UA-Compatible"/>
    <title>OCaml :: Common error messages</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <meta content="Ashish Agarwal, Esther Baruk, Christophe Troestler and many contributors" name="author"/>
    <meta content="" name="description"/>
    <meta content="" name="keywords"/>
    <meta content="OCaml (Weberizer)" name="generator"/>

    <link href="https://static.ocamlcore.org/official/images/favicon.ico" rel="shortcut icon"/>
    <link rel="stylesheet" href=".././css/bootstrap.css"/>
    <link href=".././css/ocaml.css" media="all" type="text/css" rel="stylesheet"/>
    <link rel="stylesheet" href=".././css/bootstrap-responsive.css"/>

    
    

    <meta content="Common error messages" property="og:title"/>
    <meta content="non_profit" property="og:type"/>

    <meta content="all" name="robots"/>
  </head>
  <body>
    <div id="header">
      <div class="top">
      </div>
      <div class="bottom">
      </div>
    </div>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
	  
          <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a href=".././" class="brand">OCaml</a>

          <div class="nav-collapse">
            <ul class="nav">
	      <li class="dropdown">
  <a href="../#" class="dropdown-toggle" data-toggle="dropdown">
    Discover
    <b class="caret"></b>
  </a>
  <ul class="dropdown-menu">
    <li><a href="../description.html">What is OCaml?</a></li>
    <li><a href="http://try.ocamlpro.com/">Try it Online</a></li>
    <li><a href="../taste.html">100 Lines of OCaml</a></li>
    <li><a href="../success.html">Success Stories</a></li>
    <li><a href="../companies.html">Who Is Using It?</a></li>
    <li><a href="http://pleac.sourceforge.net/pleac_ocaml/">Pleac</a></li>
    <li><a href="http://rosettacode.org/wiki/Category:OCaml">Rosetta</a>
        <a href="http://langref.org/ocaml">langref.org</a></li>
  </ul>
</li>
<li class="dropdown">
  <a href="../#" class="dropdown-toggle" data-toggle="dropdown">
    Learn
    <b class="caret"></b></a>
  <ul class="dropdown-menu">
    <li><a href="../install.html">Install</a></li>
    <li><a href="../tutorials/">Tutorials</a></li>
    <li><a href="../faq.html">FAQ</a></li>
    <li><a href="../books.html">Books</a></li>
    <li><a href="../videos.html">Videos</a></li>
    <li><a href="../papers.html">Papers</a></li>
  </ul>
</li>
<li class="dropdown">
  <a href="../#" class="dropdown-toggle" data-toggle="dropdown">Use
    <b class="caret"></b></a>
  <ul class="dropdown-menu">
    <li><a href="../releases/latest.html">Releases</a></li>
    <li><a href="../libraries.html">Libraries</a></li>
    <li><a href="../dev_tools.html">Development Tools</a></li>
    <li><a href="../books.html#manual">User Manual</a></li>
    <li><a href="../cheat_sheets.html">Cheat Sheets</a></li>
    <li><a href="http://search.ocaml.jp/">OCaml API Search</a></li>
    <li><a href="http://forge.ocamlcore.org/">Forge</a></li>
    <li><a href="https://github.com/languages/OCaml">GitHub</a></li>
    <li><a href="https://bitbucket.org/repo/all?name=ocaml">Bitbucket</a></li>
  </ul>
</li>
<li class="dropdown">
  <a href="../#" class="dropdown-toggle" data-toggle="dropdown">Community
    <b class="caret"></b></a>
  <ul class="dropdown-menu">
    <li><a href="../mailing_lists.html">Mailing Lists</a></li>
    <li><a href="../planet/">Blogs</a></li>
    <li><a href="../meetings.html">Meetings</a></li>
    <li><a href="irc://irc.freenode.net/ocaml">IRC</a></li>
    <li><a href="http://stackoverflow.com/questions/tagged?tagnames=ocaml">Stack Overflow</a></li>
    <li><a href="http://www.reddit.com/r/ocaml/">Reddit</a></li>
    <li><a href="../support.html">Commercial Support</a></li>
  </ul>
</li>
<li class="dropdown">
  <a href="../#" class="dropdown-toggle" data-toggle="dropdown">More
    <b class="caret"></b></a>
  <ul class="dropdown-menu">
    <li><a href="http://caml.inria.fr/mantis/">Mantis Bug Tracker</a></li>
    <li><a href="../caml-light/">Caml Light</a></li>
    <li><a href="../logos.html">Logos</a></li>
  </ul>
</li>

            </ul>
	    <form action="http://www.google.com/search" method="get" class="navbar-search pull-right">
	      <input placeholder="Search" class="search-query" name="q" type="text"/>
	      <input value="site:http://www.ocaml.org/" name="q" type="hidden"/>
	    </form>
            
	    
          </div>
        </div>
      </div>
    </div>

    <div class="container">
      <span class="navigation-bar">
	<a href="./../">Home</a><span class="separation"><img src=".././img/right_arrow.png" alt="&gt;"/></span><a href="./">Tutorials</a><span class="separation"><img src=".././img/right_arrow.png" alt="&gt;"/></span>Common error messages
	<span id="language">
	  <span class="horizontal-toolbar"><span class="open-bracket">[</span><span class="current-url">En</span><span class="close-bracket">]</span></span>
	</span>
      </span>

      
<h1><span>Common error messages</span></h1>

<p>This page gives a list of quick explanations for some error or warning messages that are emitted by the OCaml compilers. Longer explanations are usually given in dedicated sections of this tutorial.</p>
<a name="Type_errors"></a><h2><span>Type errors</span></h2>
<h3>This expression has type ... but is here used with type ...</h3>
<p>When the type of an object is not compatible with the context in which it is used, it is frequent to obtain this kind of message:</p>
<pre><span class="ocamltop-prompt"># </span><span class="ocamltop-input">1 + 2.5</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-error">File &quot;&quot;, line 1, characters 4-7:
Error: This expression has type float but an expression was expected of type
         int
</span></pre>

<p>&quot;This expression has type <em>X</em> but is here used with type <em>Y</em>&quot; means that if the contents of the expression is isolated (2.5), its type  is inferred as <em>X</em> (float). But the context, i.e. everything which is around (1 + ...) tells that the gap expects an expression of type <em>Y</em> (int) which is not compatible with <em>X</em>.</p>
<p>More disturbing is the following message:</p>
<pre>
 This expression has type my_type but is here used with type my_type
</pre>

<p>This error happens often while testing some type definitions using the toplevel.  In OCaml, it is perfectly legal to define a type with a name that is already taken by another type. Consider the following session:</p>
<pre><span class="ocamltop-prompt"># </span><span class="ocamltop-input"><span class="kwa">type</span> <span class="ocaml-mod">my_type</span> = A | B</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr"></span>type my_type = A | B
</span><span class="ocamltop-prompt"># </span><span class="ocamltop-input"><span class="kwa">let </span><span class="ocaml-variable">a</span> = A</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr"></span>val a : my_type = A
</span><span class="ocamltop-prompt"># </span><span class="ocamltop-input"><span class="kwa">type</span> <span class="ocaml-mod">my_type</span> = A | B</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr"></span>type my_type = A | B
</span><span class="ocamltop-prompt"># </span><span class="ocamltop-input"><span class="kwa">let </span><span class="ocaml-variable">b</span> = B</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr"></span>val b : my_type = B
</span><span class="ocamltop-prompt"># </span><span class="ocamltop-input">a = b</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-error">File &quot;&quot;, line 1, characters 4-5:
Error: This expression has type my_type/2749
       but an expression was expected of type my_type/2745
</span></pre>

<p>For the compiler, the second definition of my_type is totally independent from the first definition. So we have defined two types which have the same name. Since &quot;a&quot; was defined earlier, it belongs to the first type while &quot;b&quot; belongs to the second type. In this example, redefining &quot;a&quot; after the last definition of my_type solves the problem. This kind of problem should not happen in real programs unless you use the same name for the same type in the same module, which is highly discouraged.</p>
<h3>Warning: This optional argument cannot be erased</h3>
<p>Functions with optional arguments must have at least one non-labelled argument. For instance, this is not OK:</p>
<pre><span class="ocamltop-prompt"># </span><span class="ocamltop-input"><span class="kwa">let</span> <span class="ocaml-function">f</span> <span class="ocaml-variable">?(x = 0) ?(y = 0) </span>= print_int (x + y)</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr">File &quot;&quot;, line 1, characters 15-43:
Warning 16: this optional argument cannot be erased.
</span>val f : ?x:int -&gt; ?y:int -&gt; unit = &lt;fun&gt;
</span></pre>

<p>The solution is simply to add one argument of type unit, like this:</p>
<pre><span class="ocamltop-prompt"># </span><span class="ocamltop-input"><span class="kwa">let</span> <span class="ocaml-function">f</span> <span class="ocaml-variable">?(x = 0) ?(y = 0) () </span>= print_int (x + y)</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr"></span>val f : ?x:int -&gt; ?y:int -&gt; unit -&gt; unit = &lt;fun&gt;
</span></pre>

<p>See the <a title="Labels" class="internal" href="labels.html">Labels</a> section for more details on functions with labelled arguments.</p>

<h3>The type of this expression... contains type variables that cannot be generalized</h3>

<p>This happens in some cases when the full type of an object is not
known by the compiler when it reaches the end of the compilation unit
(file) but for some reason it cannot remain polymorphic. Example:</p>
<pre><span class="listing"><span class="kwa">let </span><span class="ocaml-variable">x</span> = <span class="kwb">ref</span> None</span></pre>
<p>triggers the following message during the compilation:</p>
<pre>
The type of this expression, '_a option ref,
contains type variables that cannot be generalized
</pre>

<p>Solution: help the compiler with a type annotation, like for instance:</p>
<pre><span class="listing">let x : string option <span class="kwb">ref</span> = <span class="kwb">ref</span> None</span></pre>
<p>or:</p>
<pre><span class="listing"><span class="kwa">let </span><span class="ocaml-variable">x</span> = <span class="kwb">ref</span> (None : string option)</span></pre>

<p>Data of type <code>'_a</code> may be allowed temporarily, for
  instance during a toplevel session. It means that the given object has
  an unknown type, but it cannot be any type: it is not polymorphic
  data. In the toplevel, our example gives these results:</p>
<pre><span class="ocamltop-prompt"># </span><span class="ocamltop-input"><span class="kwa">let </span><span class="ocaml-variable">x</span> = <span class="kwb">ref</span> None</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr"></span>val x : '_a option ref = {contents = None}
</span></pre>

<p>The compiler tells us that the type of x is not fully known
  yet. But by using <code>x</code> later, the compiler can infer the
  type of&nbsp;<code>x</code>:</p>
<pre><span class="ocamltop-prompt"># </span><span class="ocamltop-input">x := Some 0</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr"></span>- : unit = ()
</span></pre>
<p>Now <code>x</code> has a known type:</p>
<pre><span class="ocamltop-prompt"># </span><span class="ocamltop-input">x</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr"></span>- : int option ref = {contents = Some 0}
</span></pre>

<p>More details are given in the <a title="http://caml.inria.fr/pub/old_caml_site/FAQ/FAQ_EXPERT-eng.html#variables_de_types_faibles" class="external" href="http://caml.inria.fr/pub/old_caml_site/FAQ/FAQ_EXPERT-eng.html#variables_de_types_faibles">OCaml FAQ</a>.</p>

<h2><a name="Pattern_matching_warnings_and_errors"></a>
  Pattern matching warnings and errors</h2>

<h3>This pattern is unused</h3>

<p>This warning should be considered as an error, since there is no reason to intentionally keep such code. It may happen when the programmer introduced a catch-all pattern unintentionally such as in the following situation:</p>
<pre><span class="ocamltop-prompt"># </span><span class="ocamltop-input"><span class="kwa">let</span> <span class="ocaml-function">test_member</span> <span class="ocaml-variable">x tup </span>=
    <span class="kwb">match</span> tup <span class="kwb">with</span>
    | (y, _) | (_, y) when y = x -&gt; true
    | _ -&gt; false</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr">File &quot;&quot;, line 3, characters 16-20:
Warning 12: this sub-pattern is unused.
</span>val test_member : 'a -&gt; 'a * 'a -&gt; bool = &lt;fun&gt;
</span></pre>

<p>Obviously, the programmer had a misconception of what OCaml's pattern matching is about. Remember the following:</p>
<ul><li>the tree of cases is traversed linearly, from left to right. There is <em>no backtracking</em> as in regexp matching.</li>
<li>a guard (&quot;when&quot; clause) is not part of a pattern. It is simply a condition which is evaluated at most once and is used as a last resort to jump to the next match case.</li>
<li>lowercase identifiers (bindings such as &quot;y&quot; above) are just names, so they will always match.</li></ul>
<p>In our example, it is now clear that only the first item of the pair will ever be tested. This leads to the following results:</p>
<pre><span class="ocamltop-prompt"># </span><span class="ocamltop-input">test_member 1 (1, 0)</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr"></span>- : bool = true
</span><span class="ocamltop-prompt"># </span><span class="ocamltop-input">test_member 1 (0, 1)</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr"></span>- : bool = false
</span></pre>

<h3>This pattern-matching is not exhaustive</h3>
<p>OCaml's pattern matching can check whether a set of patterns is exhaustive or not, based on the <em>type</em> only. So in the following example, the compiler doesn't know what range of ints the &quot;mod&quot; operator would return:</p>
<pre><span class="ocamltop-prompt"># </span><span class="ocamltop-input"><span class="kwa">let</span> <span class="ocaml-function">is_even</span> <span class="ocaml-variable">x </span>=
    <span class="kwb">match</span> x mod 2 <span class="kwb">with</span>
    | 0 -&gt; true
    | 1 | -1 -&gt; false</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr">File &quot;&quot;, line 2, characters 4-60:
Warning 8: this pattern-matching is not exhaustive.
Here is an example of a value that is not matched:
2
</span>val is_even : int -&gt; bool = &lt;fun&gt;
</span></pre>

<p>A short solution without pattern matching would be:</p>
<pre><span class="ocamltop-prompt"># </span><span class="ocamltop-input"><span class="kwa">let</span> <span class="ocaml-function">is_even</span> <span class="ocaml-variable">x </span>= x mod 2 = 0</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr"></span>val is_even : int -&gt; bool = &lt;fun&gt;
</span></pre>

<p>In general, that kind of simplification is not possible and the best solution is to add a catch-all case which should never be reached:</p>
<pre><span class="ocamltop-prompt"># </span><span class="ocamltop-input"><span class="kwa">let</span> <span class="ocaml-function">is_even</span> <span class="ocaml-variable">x </span>=
    <span class="kwb">match</span> x mod 2 <span class="kwb">with</span>
    | 0 -&gt; true
    | 1 | -1 -&gt; false
    | _ -&gt; <span class="kwb">assert</span> false</span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr"></span>val is_even : int -&gt; bool = &lt;fun&gt;
</span></pre>


<h2><a name="Problems_recompiling_valid_programs"></a>
  Problems recompiling valid programs</h2>

<h3>x.cmi is not a compiled interface</h3>
<p>When recompiling some old program or compiling a program from an external source that was not cleaned properly, it is possible to get this error message:</p>
<pre>
some_module.cmi is not a compiled interface
</pre>

<p>It means that some_module.cmi is not valid according to the <em>current version</em> of the OCaml compiler. Most of the time, removing the old compiled files (*.cmi, *.cmo, *.cmx, ...) and recompiling is sufficient to solve this problem.</p>

<h3>Warning: Illegal backslash escape in string</h3>
<p>Recent versions of OCaml warn you against unprotected backslashes in strings since they should be doubled. Such a message may be displayed when compiling an older program, and can be turned off with the &quot;-w x&quot; option.</p>
<pre><span class="ocamltop-prompt"># </span><span class="ocamltop-input">&quot;\e\n&quot; <span class="ocaml-comment">(* bad practice *)</span></span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr">Warning: File &quot;&quot;, line 1, characters 1-3: Illegal backslash escape in string or character (e)
</span>- : string = &quot;\\e\n&quot;
</span><span class="ocamltop-prompt"># </span><span class="ocamltop-input">&quot;\\e\n&quot; <span class="ocaml-comment">(* good practice *)</span></span><span class="ocamltop-prompt">;;</span><br/><span class="ocamltop-output"><span class="ocamltop-stdout"></span><span class="ocamltop-stderr"></span>- : string = &quot;\\e\n&quot;
</span></pre>




    </div>

    
    <br/>
    <hr/>
    <div id="footer">
      Contribute to this project!
      Find us on <a href="https://github.com/ocaml/ocaml.org">Github</a>.
    </div>
    <span title=".././img/ = image directory from the base of the site"></span>


    
    
    

    <script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
    <script src=".././js/jquery-1.8.0.min.js"></script>
    
    <script src=".././js/bootstrap.js"></script>
    <script type="text/javascript">
      var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-22552764-2']); _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
</body></html>
